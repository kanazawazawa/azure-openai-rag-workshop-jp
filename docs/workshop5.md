## プロジェクトの概要

フォークしたプロジェクトテンプレートはモノレポであり、複数のプロジェクトを含む単一のリポジトリです。以下は、主要なファイルとディレクトリに焦点を当てた構成です：

```sh
.devcontainer/  # 開発コンテナの設定
data/           # カスタムデータとして使用するサンプルPDF
infra/          # Azureインフラストラクチャのテンプレートとスクリプト
scripts/        # ドキュメント取り込み用のユーティリティスクリプト
src/            # アプリケーションのサービスのソースコード
|- backend/     # チャットAPI
|- frontend/    # チャットウェブサイト
|- ingestion/   # ドキュメント取り込みサービス
package.json    # NPMワークスペースの設定
.env            # 環境変数用に作成したファイル
```

私たちはAPIとウェブサイトにNode.jsを使用しており、すべてのプロジェクトの依存関係を単一の場所から管理するために[NPMワークスペース](https://docs.npmjs.com/cli/using-npm/workspaces)を設定しています。ルートで`npm install`を実行すると、すべてのプロジェクトの依存関係がインストールされ、モノレポの管理が簡素化されます。

例えば、`npm run <script_name> --workspaces`はすべてのプロジェクトでスクリプトを実行し、`npm run <script_name> --workspace=backend`はバックエンドのみを対象とします。

それ以外の場合は、任意のプロジェクトフォルダで通常の`npm`コマンドを使用でき、通常通り動作します。

### サービスについて

私たちは使用するフレームワークのCLIまたはジェネレーターを使用して、各サービスの基本コードを生成し、いくつかのサービスコンポーネントを事前に作成しているため、最も興味深い部分にすぐに取り組むことができます。

### チャットAPIの仕様

チャットのような体験を作成するには、ユーザーインターフェースとサービスAPIの2つの主要なコンポーネントが必要です。[AIチャットプロトコルAPI仕様](https://aka.ms/chatprotocol)は、それらの相互作用を標準化します。この標準化により、さまざまなプログラミング言語で記述されたチャットサービスとシームレスにやり取りできる異なるクライアントアプリケーション（モバイルアプリなど）の開発が可能になります。

#### チャットリクエスト

チャットリクエストはJSON形式で送信され、少なくともユーザーのメッセージを含む必要があります。他のオプションのパラメータには、応答をストリーミングするかどうかを示すフラグ、チャットサービスの動作を調整できるコンテキスト固有のオプション、およびリクエスト間で状態を維持するために使用できるセッション状態オブジェクトが含まれます。

```json
{
  "messages": [
    {
      "content": "スキューバダイビングはできますか？",
      "role": "user"
    }
  ],
  "context": { ... }
}
```

#### チャット応答

チャットサービスは、生成された応答を表すJSONオブジェクトで応答します。回答はメッセージの`content`プロパティにあります。

```json
{
  "message": {
    "content": "提供された情報源にはスキューバダイビングに関する情報はありません。",
    "role": "assistant",
  },
  "context": { ... }
}
```

[AIチャットプロトコルAPI仕様の詳細はこちら](https://aka.ms/chatprotocol)をご覧ください。

<div class="info" data-title="note">

> ストリーミングが有効になっている場合、応答はJSONオブジェクトのストリームになり、それぞれが応答のチャンクを表します。この形式により、各チャンクが準備でき次第送信およびレンダリングされるため、動的でリアルタイムのメッセージング体験が可能になります。この場合、応答形式は[Newline Delimited JSON (NDJSON)](https://github.com/ndjson/ndjson-spec)仕様に従い、構造化データを1レコードずつ処理する便利な方法です。

</div>


---